<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gaming Platform - –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/admin.css">
</head>
<body>
    <header class="header">
        <nav class="nav container">
            <div class="logo">üõ°Ô∏è –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</div>
            <ul class="nav-links">
                <li><a href="/" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a></li>
                <li><a href="/dashboard" class="nav-link">–ü–∞–Ω–µ–ª—å</a></li>
                <li><a href="/admin" class="nav-link active">–ê–¥–º–∏–Ω</a></li>
            </ul>
            <div class="nav-auth" id="navAuth">
                <span id="adminName" class="admin-name"></span>
                <button onclick="gamePlatform.logout()" class="glass-button">–í—ã–π—Ç–∏</button>
            </div>
        </nav>
    </header>

    <main class="admin-main">
        <div class="container">
            <!-- Admin Stats -->
            <section class="admin-stats">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üë•</div>
                        <div class="stat-content">
                            <h3 id="totalUsers">0</h3>
                            <p>–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìã</div>
                        <div class="stat-content">
                            <h3 id="totalSubmissions">0</h3>
                            <p>–í—Å–µ–≥–æ –∑–∞—è–≤–æ–∫</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚è≥</div>
                        <div class="stat-content">
                            <h3 id="pendingSubmissions">0</h3>
                            <p>–û–∂–∏–¥–∞—é—Ç –º–æ–¥–µ—Ä–∞—Ü–∏–∏</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-content">
                            <h3 id="totalPayouts">0</h3>
                            <p>–í—Å–µ–≥–æ –≤—ã–ø–ª–∞—á–µ–Ω–æ</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Admin Tabs -->
            <section class="admin-tabs">
                <div class="tab-nav">
                    <button class="tab-btn active" data-tab="submissions">–ó–∞—è–≤–∫–∏</button>
                    <button class="tab-btn" data-tab="users">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
                    <button class="tab-btn" data-tab="logs">–õ–æ–≥–∏</button>
                </div>

                <!-- Submissions Tab -->
                <div class="tab-content active" id="submissions-tab">
                    <div class="tab-header">
                        <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏</h2>
                        <div class="tab-actions">
                            <select id="submissionStatusFilter" class="form-select">
                                <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                                <option value="PENDING">–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏</option>
                                <option value="APPROVED">–û–¥–æ–±—Ä–µ–Ω–æ</option>
                                <option value="REJECTED">–û—Ç–∫–ª–æ–Ω–µ–Ω–æ</option>
                            </select>
                            <select id="submissionCategoryFilter" class="form-select">
                                <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                            </select>
                            <button class="glass-button" onclick="adminPanel.loadSubmissions()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                        </div>
                    </div>

                    <div class="bulk-actions" id="bulkActions" style="display: none;">
                        <div class="bulk-info">
                            <span id="selectedCount">0</span> –∑–∞—è–≤–æ–∫ –≤—ã–±—Ä–∞–Ω–æ
                        </div>
                        <div class="bulk-buttons">
                            <button class="btn btn-primary" onclick="adminPanel.bulkApprove()">‚úÖ –û–¥–æ–±—Ä–∏—Ç—å</button>
                            <button class="btn btn-danger" onclick="adminPanel.bulkReject()">‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
                        </div>
                    </div>

                    <div class="submissions-container">
                        <div id="submissionsTable" class="table-container">
                            <!-- Submissions table will be loaded here -->
                        </div>
                        <div id="submissionsLoading" class="loading-state hidden">
                            <div class="spinner"></div>
                            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞—è–≤–æ–∫...</p>
                        </div>
                        <div class="pagination" id="submissionsPagination"></div>
                    </div>
                </div>

                <!-- Users Tab -->
                <div class="tab-content" id="users-tab">
                    <div class="tab-header">
                        <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h2>
                        <div class="tab-actions">
                            <input type="text" id="userSearch" class="form-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∏–∫–Ω–µ–π–º—É...">
                            <select id="userRoleFilter" class="form-select">
                                <option value="">–í—Å–µ —Ä–æ–ª–∏</option>
                                <option value="USER">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
                                <option value="MODERATOR">–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä</option>
                                <option value="ADMIN">–ê–¥–º–∏–Ω</option>
                            </select>
                            <button class="glass-button" onclick="adminPanel.loadUsers()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                        </div>
                    </div>

                    <div class="users-container">
                        <div id="usersTable" class="table-container">
                            <!-- Users table will be loaded here -->
                        </div>
                        <div id="usersLoading" class="loading-state hidden">
                            <div class="spinner"></div>
                            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...</p>
                        </div>
                        <div class="pagination" id="usersPagination"></div>
                    </div>
                </div>

                <!-- Logs Tab -->
                <div class="tab-content" id="logs-tab">
                    <div class="tab-header">
                        <h2>–õ–æ–≥–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
                        <div class="tab-actions">
                            <select id="logsActionFilter" class="form-select">
                                <option value="">–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è</option>
                                <option value="REVIEW_SUBMISSION">–ú–æ–¥–µ—Ä–∞—Ü–∏—è –∑–∞—è–≤–æ–∫</option>
                                <option value="ADD_BALANCE">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞</option>
                                <option value="UPDATE_USER">–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</option>
                            </select>
                            <button class="glass-button" onclick="adminPanel.loadLogs()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                        </div>
                    </div>

                    <div class="logs-container">
                        <div id="logsTable" class="table-container">
                            <!-- Logs table will be loaded here -->
                        </div>
                        <div id="logsLoading" class="loading-state hidden">
                            <div class="spinner"></div>
                            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ–≤...</p>
                        </div>
                        <div class="pagination" id="logsPagination"></div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Submission Review Modal -->
    <div id="reviewModal" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h2 class="modal-title">–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏</h2>
                <button class="modal-close" onclick="gamePlatform.closeModal('reviewModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div id="reviewContent">
                    <!-- Content will be loaded dynamically -->
                </div>
            </div>
        </div>
    </div>

    <!-- User Edit Modal -->
    <div id="userEditModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
                <button class="modal-close" onclick="gamePlatform.closeModal('userEditModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="userEditForm" class="form">
                    <input type="hidden" id="editUserId" name="userId">
                    
                    <div class="form-group">
                        <label class="form-label">–ù–∏–∫–Ω–µ–π–º</label>
                        <input type="text" id="editUserNickname" class="form-input" readonly>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="editUserRole">–†–æ–ª—å</label>
                        <select id="editUserRole" name="role" class="form-select">
                            <option value="USER">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
                            <option value="MODERATOR">–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä</option>
                            <option value="ADMIN">–ê–¥–º–∏–Ω</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="editUserBalance">–ë–∞–ª–∞–Ω—Å</label>
                        <input type="number" id="editUserBalance" name="balance" class="form-input" 
                               step="0.01" min="0" max="100000">
                    </div>

                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="editUserBanned" name="isBanned">
                            <span>–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</span>
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="gamePlatform.closeModal('userEditModal')">
                    –û—Ç–º–µ–Ω–∞
                </button>
                <button type="button" class="btn btn-primary" onclick="adminPanel.saveUserChanges()">
                    –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                </button>
            </div>
        </div>
    </div>

    <!-- Add Balance Modal -->
    <div id="addBalanceModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å</h2>
                <button class="modal-close" onclick="gamePlatform.closeModal('addBalanceModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="addBalanceForm" class="form">
                    <input type="hidden" id="balanceUserId" name="userId">
                    
                    <div class="form-group">
                        <label class="form-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</label>
                        <input type="text" id="balanceUserNickname" class="form-input" readonly>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="balanceAmount">–°—É–º–º–∞ *</label>
                        <input type="number" id="balanceAmount" name="amount" class="form-input" 
                               step="0.01" min="0.01" max="10000" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="balanceReason">–ü—Ä–∏—á–∏–Ω–∞ *</label>
                        <textarea id="balanceReason" name="reason" class="form-input form-textarea" 
                                  required placeholder="–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞" maxlength="200"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="gamePlatform.closeModal('addBalanceModal')">
                    –û—Ç–º–µ–Ω–∞
                </button>
                <button type="button" class="btn btn-primary" onclick="adminPanel.addUserBalance()">
                    –î–æ–±–∞–≤–∏—Ç—å
                </button>
            </div>
        </div>
    </div>

    <!-- Bulk Reject Modal -->
    <div id="bulkRejectModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">–ú–∞—Å—Å–æ–≤–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ</h2>
                <button class="modal-close" onclick="gamePlatform.closeModal('bulkRejectModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="bulkRejectForm" class="form">
                    <div class="form-group">
                        <label class="form-label" for="bulkRejectReason">–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è *</label>
                        <textarea id="bulkRejectReason" name="reason" class="form-input form-textarea" 
                                  required placeholder="–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –∑–∞—è–≤–æ–∫" maxlength="200"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="gamePlatform.closeModal('bulkRejectModal')">
                    –û—Ç–º–µ–Ω–∞
                </button>
                <button type="button" class="btn btn-danger" onclick="adminPanel.confirmBulkReject()">
                    –û—Ç–∫–ª–æ–Ω–∏—Ç—å –∑–∞—è–≤–∫–∏
                </button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay hidden">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="successToast" class="toast toast-success hidden">
        <div class="toast-content">
            <span class="toast-icon">‚úÖ</span>
            <span class="toast-message"></span>
        </div>
    </div>

    <div id="errorToast" class="toast toast-error hidden">
        <div class="toast-content">
            <span class="toast-icon">‚ùå</span>
            <span class="toast-message"></span>
        </div>
    </div>

    <script src="scripts/main.js"></script>
    <script src="scripts/auth.js"></script>
    <script src="scripts/admin.js"></script>
</body>
</html>